# SampleCrossNum: Sample number of crossing over from Poisson distribution
# parameter:
# 1. map: the map created by "createQTLpos", consisting of locations of markers and QTLs.
#         can be accessed by extract the first object of the list generated by "createQTLpos"
# 2. ngam: number of gametes to generate 
SampleCrossNum <- function(map, ngam = 1){
  nchr <- length(unique(map[,1]))
  if(nchr > 1){
    chrlen <- tapply(map[,2], INDEX = map[,1], max)/100
  }else{
    chrlen <- max(map[,1])/100
  }
  
  #structure of "out": rows for chromosomes; columns for gametes; each element is the number of crossing over
  out <- matrix(rpois(n = ngam*12, lambda = rep(chrlen, ngam*12)), ncol = ngam, byrow = F) 
  rownames(out) <- paste("chr", 1:nchr, sep = "")
  colnames(out) <- paste("gamete", 1:ngam, sep = "")
  return(out)
} # SampleCrossNum end
